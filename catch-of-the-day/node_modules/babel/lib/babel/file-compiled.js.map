{"version":3,"sources":["file.js"],"names":[],"mappings":"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","file":"file-compiled.js","sourcesContent":["\"use strict\";\n\nvar convertSourceMap = require(\"convert-source-map\");\nvar pathExists = require(\"path-exists\");\nvar sourceMap = require(\"source-map\");\nvar chokidar = require(\"chokidar\");\nvar slash = require(\"slash\");\nvar path = require(\"path\");\nvar util = require(\"./util\");\nvar fs = require(\"fs\");\nvar _ = require(\"lodash\");\n\nmodule.exports = function (commander, filenames, opts) {\n  if (commander.sourceMaps === \"inline\") {\n    opts.sourceMaps = true;\n  }\n\n  var results = [];\n\n  var buildResult = function buildResult() {\n    var map = new sourceMap.SourceMapGenerator({\n      file: path.basename(commander.outFile) || \"stdout\",\n      sourceRoot: opts.sourceRoot\n    });\n\n    var code = \"\";\n    var offset = 0;\n\n    _.each(results, function (result) {\n      var filename = result.filename;\n      code += result.code + \"\\n\";\n\n      if (result.map) {\n        var consumer = new sourceMap.SourceMapConsumer(result.map);\n\n        var sourceFilename = filename;\n        if (commander.outFile) {\n          sourceFilename = path.relative(path.dirname(commander.outFile), sourceFilename);\n        }\n        sourceFilename = slash(sourceFilename);\n\n        map._sources.add(sourceFilename);\n        map.setSourceContent(sourceFilename, result.actual);\n\n        consumer.eachMapping(function (mapping) {\n          map._mappings.add({\n            generatedLine: mapping.generatedLine + offset,\n            generatedColumn: mapping.generatedColumn,\n            originalLine: mapping.originalLine,\n            originalColumn: mapping.originalColumn,\n            source: sourceFilename\n          });\n        });\n\n        offset = code.split(\"\\n\").length;\n      }\n    });\n\n    if (commander.sourceMaps === \"inline\" || !commander.outFile && commander.sourceMaps) {\n      code += \"\\n\" + convertSourceMap.fromObject(map).toComment();\n    }\n\n    return {\n      map: map,\n      code: code\n    };\n  };\n\n  var output = function output() {\n    var result = buildResult();\n\n    if (commander.outFile) {\n      if (commander.sourceMaps && commander.sourceMaps !== \"inline\") {\n        var mapLoc = commander.outFile + \".map\";\n        result.code = util.addSourceMappingUrl(result.code, mapLoc);\n        fs.writeFileSync(mapLoc, JSON.stringify(result.map));\n      }\n\n      fs.writeFileSync(commander.outFile, result.code);\n    } else {\n      process.stdout.write(result.code + \"\\n\");\n    }\n  };\n\n  var stdin = function stdin() {\n    var code = \"\";\n\n    process.stdin.setEncoding(\"utf8\");\n\n    process.stdin.on(\"readable\", function () {\n      var chunk = process.stdin.read();\n      if (chunk !== null) code += chunk;\n    });\n\n    process.stdin.on(\"end\", function () {\n      results.push(util.transform(commander.filename, code));\n      output();\n    });\n  };\n\n  var walk = function walk() {\n    var _filenames = [];\n    results = [];\n\n    _.each(filenames, function (filename) {\n      if (!pathExists.sync(filename)) return;\n\n      var stat = fs.statSync(filename);\n      if (stat.isDirectory()) {\n        var dirname = filename;\n\n        _.each(util.readdirFilter(filename), function (filename) {\n          _filenames.push(path.join(dirname, filename));\n        });\n      } else {\n        _filenames.push(filename);\n      }\n    });\n\n    _.each(_filenames, function (filename) {\n      if (util.shouldIgnore(filename)) return;\n\n      var data = util.compile(filename);\n      if (data.ignored) return;\n      results.push(data);\n    });\n\n    output();\n  };\n\n  var files = function files() {\n    walk();\n\n    if (commander.watch) {\n      chokidar.watch(filenames, {\n        persistent: true,\n        ignoreInitial: true\n      }).on(\"all\", function (type, filename) {\n        if (type === \"add\" || type === \"change\") {\n          util.log(type + \" \" + filename);\n          try {\n            walk();\n          } catch (err) {\n            console.error(err.stack);\n          }\n        }\n      });\n    }\n  };\n\n  if (filenames.length) {\n    files();\n  } else {\n    stdin();\n  }\n};"]}