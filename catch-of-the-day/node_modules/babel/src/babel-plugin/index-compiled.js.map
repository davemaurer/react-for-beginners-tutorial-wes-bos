{"version":3,"sources":["index.js"],"names":[],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,SAAS,KAAT,CAAe,GAAf,EAAoB,IAApB,EAA0B,QAA1B,EAAoC;AAClC,UAAQ,GAAR,CAAY,GAAZ,EAAiB,GAAjB,EAAsB,IAAtB;;AAEA,MAAI,QAAQ,wBAAM,KAAN,CAAY,GAAZ,EAAiB,IAAjB,EAAuB,EAAE,OAAO,SAAT,EAAvB,CAAZ;;AAEA,QAAM,EAAN,CAAS,MAAT,EAAiB,UAAU,IAAV,EAAgB;AAC/B,QAAI,SAAS,CAAb,EAAgB;AACd;AACD,KAFD,MAEO;AACL,cAAQ,GAAR,CAAY,YAAZ;AACA,cAAQ,IAAR,CAAa,CAAb;AACD;AACF,GAPD;AAQD;;AAED,SAAS,aAAT,CAAuB,IAAvB,EAA6B;AAC3B,WAAS,IAAT,GAAgB;AACd,QAAI,MAAM,KAAK,KAAL,EAAV;AACA,QAAI,GAAJ,EAAS;AACP,YAAM,IAAI,OAAV,EAAmB,IAAI,IAAvB,EAA6B,IAA7B;AACD,KAFD,MAEO;AACL,cAAQ,IAAR;AACD;AACF;;AAED;AACD;;AAED,SAAS,QAAT,CAAkB,IAAlB,EAAmC;AAAA,MAAX,IAAW,yDAAJ,EAAI;;AACjC,MAAI,SAAS,aAAG,YAAH,CAAgB,eAAK,IAAL,CAAU,SAAV,EAAqB,WAArB,EAAkC,IAAlC,CAAhB,EAAyD,MAAzD,CAAb;AACA,WAAS,OAAO,OAAP,CAAe,UAAf,EAA2B,UAAU,GAAV,EAAe;AACjD,WAAO,KAAK,GAAL,MAAc,SAAd,GAA0B,GAA1B,GAAgC,KAAK,GAAL,CAAvC;AACD,GAFQ,CAAT;AAGA,SAAO,MAAP;AACD;;AAED,SAAS,KAAT,CAAe,QAAf,EAAyB,OAAzB,EAAkC;AAChC,UAAQ,GAAR,CAAY,QAAZ;AACA,eAAG,aAAH,CAAiB,QAAjB,EAA2B,OAA3B;AACD;;AAED,SAAS,SAAT,CAAmB,GAAnB,EAAwB;AACtB,MAAI;AACF,WAAO,wBAAM,QAAN,CAAe,GAAf,EAAoB,QAApB,EAAP;AACD,GAFD,CAEE,OAAO,GAAP,EAAY;AACZ,WAAO,EAAP;AACD;AACF;;AAED,IAAI,KAAK,mBAAS,eAAT,CAAyB;AAChC,SAAO,QAAQ,KADiB;AAEhC,UAAQ,QAAQ;AAFgB,CAAzB,CAAT;;AAKA,IAAI,sBAAsB,eAA1B;;AAEA,IAAI,OAAO;AACT,QAAM,gBAAY;AAChB,QAAI,OAAO,eAAK,QAAL,CAAc,QAAQ,GAAR,EAAd,CAAX;;AAEA,QAAI,KAAK,OAAL,CAAa,mBAAb,MAAsC,CAA1C,EAA6C;AAC3C,aAAO,KAAK,KAAL,CAAW,oBAAoB,MAA/B,CAAP;AACD;;AAED,OAAG,QAAH,CAAY,0BAAZ,EAAwC,UAAU,WAAV,EAAuB;AAC7D,UAAI,SAAS,UAAU,oCAAV,EAAgD,IAAhD,GAAuD,KAAvD,CAA6D,0BAA7D,CAAb;AACA,UAAI,MAAJ,EAAY;AACV,cAAM,WAAN,EAAmB,OAAO,CAAP,CAAnB;AACD,OAFD,MAEO;AACL,WAAG,QAAH,CAAY,iEAAZ,EAA+E,UAAU,IAAV,EAAgB;AAC7F,gBAAM,WAAN,EAAmB,IAAnB;AACD,SAFD;AAGD;AACF,KATD;;AAWA,aAAS,KAAT,CAAe,WAAf,EAA4B,IAA5B,EAAkC;AAChC,SAAG,KAAH;;AAEA,UAAI,eAAe;AACjB,qBAAa,WADI;AAEjB,mBAAW,sBAAsB,IAFhB;AAGjB,cAAM;AAHW,OAAnB;;AAMA,YAAM,cAAN,EAAsB,KAAK,SAAL,CAAe;AACnC,cAAM,aAAa,SADgB;AAEnC,iBAAS,OAF0B;AAGnC,qBAAa,aAAa,WAHS;AAInC,oBAAY,QAAQ,SAJe;AAKnC,iBAAS,KAL0B;AAMnC,cAAM,cAN6B;;AAQnC,yBAAiB;AACf,iBAAO;AADQ,SARkB;;AAYnC,iBAAS;AACP,iBAAO,oBADA;AAEP,gBAAO,sBAFA;AAGP,gBAAO;AAHA,SAZ0B;;AAkBnC,kBAAU,CAAC,cAAD;AAlByB,OAAf,EAmBnB,IAnBmB,EAmBb,IAnBa,IAmBL,IAnBjB;;AAqBA,YAAM,YAAN,EAAoB,4BAApB;;AAEA,YAAM,YAAN,EAAoB,4BAApB;;AAEA,YAAM,WAAN,EAAmB,SAAS,WAAT,EAAsB,YAAtB,CAAnB;;AAEA,YAAM,SAAN,EAAiB,SAAS,SAAT,EAAoB;AACnC,sBAAc,UAAU,6BAAV,EAAyC,IAAzC,EADqB;AAEnC,qBAAa,UAAU,4BAAV,EAAwC,IAAxC,EAFsB;AAGnC,cAAM,IAAI,IAAJ,GAAW,WAAX;AAH6B,OAApB,CAAjB;;AAMA,UAAI,CAAC,qBAAW,IAAX,CAAgB,KAAhB,CAAL,EAA6B;AAC3B,qBAAG,SAAH,CAAa,KAAb;AACA,cAAM,cAAN,EAAsB,SAAS,UAAT,EAAqB,YAArB,CAAtB;AACD;AACF;AACF,GAlEQ;;AAoET,SAAO,iBAAY;AACjB,UAAM,OAAN,EAAe,CAAC,KAAD,EAAQ,WAAR,EAAqB,KAArB,EAA4B,cAA5B,CAAf,EAA4D,QAAQ,IAApE;AACD,GAtEQ;;AAwET,WAAS,mBAAY;AACnB,QAAI,MAAM,QAAQ,QAAQ,GAAR,KAAgB,eAAxB,CAAV;AACA,YAAQ,GAAR,CAAY,kBAAZ,EAAgC,IAAI,OAApC;;AAEA,OAAG,QAAH,CAAY,yCAAZ,EAAuD,UAAU,UAAV,EAAsB;AAC3E,SAAG,KAAH;;AAEA,mBAAa,cAAc,OAA3B;;AAEA,oBAAc,CACZ,EAAE,SAAS,KAAX,EAAkB,MAAM,CAAC,MAAD,CAAxB,EADY,EAEZ,EAAE,SAAS,KAAX,EAAkB,MAAM,CAAC,MAAD,CAAxB,EAFY,EAGZ,EAAE,SAAS,cAAX,EAA2B,MAAM,CAAC,OAAD,CAAjC,EAHY,EAIZ,EAAE,SAAS,KAAX,EAAkB,MAAM,CAAC,SAAD,EAAY,UAAZ,CAAxB,EAJY,EAKZ,EAAE,SAAS,KAAX,EAAkB,MAAM,CAAC,SAAD,CAAxB,EALY,EAMZ,EAAE,SAAS,KAAX,EAAkB,MAAM,CAAC,MAAD,EAAS,eAAT,CAAxB,EANY,CAAd;AAQD,KAbD;AAcD;AA1FQ,CAAX;;AA6FA,IAAI,MAAM,KAAK,QAAQ,IAAR,CAAa,CAAb,CAAL,CAAV;AACA,IAAI,GAAJ,EAAS;AACP;AACD,CAFD,MAEO;AACL,UAAQ,KAAR,CAAc,kBAAd,EAAkC,GAAlC;AACA,UAAQ,IAAR,CAAa,CAAb;AACD","file":"index-compiled.js","sourcesContent":["import pathExists from \"path-exists\";\nimport readline from \"readline\";\nimport child from \"child_process\";\nimport path from \"path\";\nimport fs from \"fs\";\n\nfunction spawn(cmd, args, callback) {\n  console.log(\">\", cmd, args);\n\n  var spawn = child.spawn(cmd, args, { stdio: \"inherit\" });\n\n  spawn.on(\"exit\", function (code) {\n    if (code === 0) {\n      callback();\n    } else {\n      console.log(\"Killing...\");\n      process.exit(1);\n    }\n  });\n}\n\nfunction spawnMultiple(cmds) {\n  function next() {\n    var cmd = cmds.shift();\n    if (cmd) {\n      spawn(cmd.command, cmd.args, next);\n    } else {\n      process.exit();\n    }\n  }\n\n  next();\n}\n\nfunction template(name, data = {}) {\n  var source = fs.readFileSync(path.join(__dirname, \"templates\", name), \"utf8\");\n  source = source.replace(/[A-Z_]+/g, function (key) {\n    return data[key] === undefined ? key : data[key];\n  });\n  return source;\n}\n\nfunction write(filename, content) {\n  console.log(filename);\n  fs.writeFileSync(filename, content);\n}\n\nfunction execMaybe(cmd) {\n  try {\n    return child.execSync(cmd).toString();\n  } catch (err) {\n    return \"\";\n  }\n}\n\nvar rl = readline.createInterface({\n  input: process.stdin,\n  output: process.stdout\n});\n\nvar BABEL_PLUGIN_PREFIX = \"babel-plugin-\";\n\nvar cmds = {\n  init: function () {\n    var name = path.basename(process.cwd());\n\n    if (name.indexOf(BABEL_PLUGIN_PREFIX) === 0) {\n      name = name.slice(BABEL_PLUGIN_PREFIX.length);\n    }\n\n    rl.question(\"Description (optional): \", function (description) {\n      var remote = execMaybe(\"git config --get remote.origin.url\").trim().match(/git@github.com:(.*?).git/);\n      if (remote) {\n        build(description, remote[1]);\n      } else {\n        rl.question(\"GitHub Repository (eg. sebmck/babel-plugin-foobar) (optional): \", function (repo) {\n          build(description, repo);\n        });\n      }\n    });\n\n    function build(description, repo) {\n      rl.close();\n\n      var templateData = {\n        DESCRIPTION: description,\n        FULL_NAME: BABEL_PLUGIN_PREFIX + name,\n        NAME: name\n      };\n\n      write(\"package.json\", JSON.stringify({\n        name: templateData.FULL_NAME,\n        version: \"1.0.0\",\n        description: templateData.DESCRIPTION,\n        repository: repo || undefined,\n        license: \"MIT\",\n        main: \"lib/index.js\",\n\n        devDependencies: {\n          babel: \"^5.6.0\"\n        },\n\n        scripts: {\n          build: \"babel-plugin build\",\n          push:  \"babel-plugin publish\",\n          test:  \"babel-plugin test\"\n        },\n\n        keywords: [\"babel-plugin\"]\n      }, null, \"  \") + \"\\n\");\n\n      write(\".npmignore\", \"node_modules\\n*.log\\nsrc\\n\");\n\n      write(\".gitignore\", \"node_modules\\n*.log\\nlib\\n\");\n\n      write(\"README.md\", template(\"README.md\", templateData));\n\n      write(\"LICENSE\", template(\"LICENSE\", {\n        AUTHOR_EMAIL: execMaybe(\"git config --get user.email\").trim(),\n        AUTHOR_NAME: execMaybe(\"git config --get user.name\").trim(),\n        YEAR: new Date().getFullYear()\n      }));\n\n      if (!pathExists.sync(\"src\")) {\n        fs.mkdirSync(\"src\");\n        write(\"src/index.js\", template(\"index.js\", templateData));\n      }\n    }\n  },\n\n  build: function () {\n    spawn(\"babel\", [\"src\", \"--out-dir\", \"lib\", \"--copy-files\"], process.exit);\n  },\n\n  publish: function () {\n    var pkg = require(process.cwd() + \"/package.json\");\n    console.log(\"Current version:\", pkg.version);\n\n    rl.question(\"New version (enter nothing for patch): \", function (newVersion) {\n      rl.close();\n\n      newVersion = newVersion || \"patch\";\n\n      spawnMultiple([\n        { command: \"git\", args: [\"pull\"] },\n        { command: \"git\", args: [\"push\"] },\n        { command: \"babel-plugin\", args: [\"build\"] },\n        { command: \"npm\", args: [\"version\", newVersion] },\n        { command: \"npm\", args: [\"publish\"] },\n        { command: \"git\", args: [\"push\", \"--follow-tags\"] }\n      ]);\n    });\n  }\n};\n\nvar cmd = cmds[process.argv[2]];\nif (cmd) {\n  cmd();\n} else {\n  console.error(\"Unknown command:\", cmd);\n  process.exit(1);\n}\n"]}